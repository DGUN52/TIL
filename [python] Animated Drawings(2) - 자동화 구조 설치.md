
## # ìë™í™” êµ¬ì¡° ì„¤ì¹˜
> ì‚¬ìš© ê°€ì´ë“œ ğŸ‘‰ [README.md#animating-your-own-library](https://github.com/facebookresearch/AnimatedDrawings#animating-your-own-drawing)

[](https://velog.velcdn.com/images/deaf52/post/40158508-2dad-48e4-a70f-4736882ef3da/image.png)

| í˜•íƒœíŒŒì•…, ê´€ì ˆì„¤ì • | ëª¨ì…˜íŒŒì¼ ì ìš© |
| - | - |
| <img src=https://velog.velcdn.com/images/deaf52/post/40158508-2dad-48e4-a70f-4736882ef3da/image.png> | <img src=https://velog.velcdn.com/images/deaf52/post/db5f6940-c5f5-49a3-9186-492b59eaba8a/image.gif> |

- ì´ë•Œê¹Œì§€ëŠ” ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ í”„ë¦¬ì…‹ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì— ì§€ë‚˜ì§€ ì•Šì•˜ë‹¤. 

- í•˜ì§€ë§Œ [ì˜ˆì œ ì‚¬ì´íŠ¸](https://sketch.metademolab.com/)ì—ì„œ ì œê³µí•´ì£¼ëŠ” `ì´ë¯¸ì§€ ì…ë ¥` â†’ **`í˜•íƒœíŒŒì•…, ê´€ì ˆì„¤ì •`** â†’ **`ëª¨ì…˜íŒŒì¼ë¡œ ì• ë‹ˆë©”ì´ì…˜ ìƒì„±`** ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©ìì˜ ì„œë¹„ìŠ¤ì—ë„ ì ìš©í•  ìˆ˜ ìˆë„ë¡ ìë™í™” ê°€ì´ë“œë„ ê·¸ ë‹¤ìŒ ë‚´ìš©ìœ¼ë¡œ ì œê³µëœë‹¤.

- ì„¤ì •ëœ ê´€ì ˆê³¼ ìºë¦­í„°ì˜ ë²”ìœ„ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” `fix`ê¸°ëŠ¥ë„ ìˆì§€ë§Œ êµ¬í˜„í•˜ë ¤ëŠ” ì„œë¹„ìŠ¤ ë²”ìœ„ ìƒ ë³¸ ì‹œë¦¬ì¦ˆì—ì„  ìˆ˜ì •ê¸°ëŠ¥ê¹Œì§€ ë‹¤ë£¨ì§„ ì•ŠëŠ”ë‹¤.

### # 0. ë„ì»¤ ì„¤ì¹˜
>[ğŸ‘‰ ubuntu í™˜ê²½ì— ì„¤ì¹˜](https://velog.io/@deaf52/Docker-Ubuntu-%ED%99%98%EA%B2%BD%EC%97%90-%EB%8F%84%EC%BB%A4-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0)
- windowí™˜ê²½ì—ëŠ” [ê³µì‹ í™ˆí˜ì´ì§€ì˜ exeíŒŒì¼](https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe)ë¡œ ê°„ë‹¨í•˜ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.
- ì´ë¯¸ ì„¤ì¹˜ ë¼ìˆë‹¤ë©´ ìƒëµí•œë‹¤.



### # 1. docker build, docker run
ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ì„œ ì´ë¯¸ì§€ë¥¼ `build`í•˜ê³  ì»¨í…Œì´ë„ˆë¥¼ `run`í•œë‹¤.
ì´ë•Œê¹Œì§€ **ë„¤ê°€ì§€ ì„œë¡œ ë‹¤ë¥¸ í™˜ê²½ì—ì„œ ì‹¤í–‰í–ˆëŠ”ë° ëª¨ë‘ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ë‹¤.**

```bash
cd AnimatedDrawings/torchserve

# ì»´í“¨í„° ìì›ì— ë”°ë¼ 20ë¶„ ì´ìƒ ì†Œìš”ë  ìˆ˜ ìˆë‹¤.
docker build -t docker_torchserve .
docker run -d --name docker_torchserve -p 8080:8080 -p 8081:8081 docker_torchserve

# after few seconds
curl http://localhost:8080/ping
# ì¶œë ¥ìœ¼ë¡œ 'healthy'ë¼ëŠ” ë‹¨ì–´ê°€ ë– ì•¼í•œë‹¤.
# ì´ì™¸ì˜ ëª¨ë“  ë°˜í™˜ê°’ì€ ì—ëŸ¬ë¡œ ê°„ì£¼.
```
- ì•„ë¬´ ì—ëŸ¬ë„ ë°œìƒí•˜ì§€ ì•Šê³  'healthy'ë¼ëŠ” ë¦¬í„´ì„ ì˜ ëŒë ¤ë°›ì•˜ë‹¤ë©´ **#3**ìœ¼ë¡œ ë°”ë¡œ ì§„í–‰í•˜ì. ê·¸ ì™¸ì—ëŠ” **#2**ì—ì„œ ì˜¤ë¥˜ë¥¼ ì¡ê³  ê³„ì† ì§„í–‰

- `no moudle`ê´€ë ¨í•œ ì—ëŸ¬ëŠ” ì´ì „ê¹Œì§€ì˜ ê°€ì´ë“œë¥¼ ì˜ëª» ìˆ˜í–‰í–ˆì„ í™•ë¥ ì´ ë§¤ìš° ë†’ë‹¤. ì‹ ì¤‘íˆ ë†“ì¹˜ê±°ë‚˜ ì‘ì„±ì/ê°€ì´ë“œì™€ ë‹¤ë¥¸ ì ì´ ì—†ëŠ”ì§€ ì¬ì‹œë„ í•´ë³´ëŠ” ê²ƒì„ ì¶”ì²œ

- `mmcv-full==1.7.0`ì„¤ì¹˜ì— ì‹¤íŒ¨í•˜ê³  `c++17`ì„ ì‚¬ìš©í•˜ì—¬ì•¼ í•œë‹¤ëŠ” ì—ëŸ¬ëŠ” ê³µí†µì ìœ¼ë¡œ ë°œìƒí•˜ì˜€ëŠ”ë° ì•„ë˜ ëª©ì°¨ì—ì„œ ìˆ˜ì •

### # 2. mmcv-full ì„¤ì¹˜ ì˜¤ë¥˜
- êµ¬ê¸€ë§ì¤‘ [ê¹ƒí—ˆë¸Œ ì´ìŠˆ](https://github.com/open-mmlab/mmcv/issues/2860)ì—ì„œ í•´ë‹¹ ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ì˜€ê³ , ì´ë¥¼ ì ìš©í•˜ë‹ˆ ë¬¸ì œì—†ì´ `build`ì™€ `run`ì´ ë™ì‘í•˜ì˜€ë‹¤.

- ì•„ë˜ì—ì„œ ì„¤ëª…í•  ì ˆì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
  - mmcvì„¤ì¹˜íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ
  - ì´ìŠˆì—ì„œ ì œì‹œí•˜ëŠ” ë¶€ë¶„ ìˆ˜ì •(`setup.py`ì˜ 268, 362ë²ˆì§¸ ë¼ì¸)
  - ë°”ë€ `setup.py`ì„ ì´ìš©í•˜ì—¬ ë¹Œë“œí•˜ë„ë¡ ë„ì»¤íŒŒì¼ ë³€ê²½ 

1. mmcv-full ì„¤ì¹˜íŒŒì¼ ë‹¤ìš´ë¡œë“œ
```bash
# ìƒˆë¡œìš´ í´ë”ì—ì„œ ì‘ì—…
mkdir my-mmcv
cd my-mmcv
pip download mmcv-full==1.7.0

# ì••ì¶• í•´ì œ
tar -zxvf mmcv-full-1.7.0.tar.gz
rm -rf mmcv-full-1.7.0.tar.gz
```

2. `setup.py` ìˆ˜ì •(ì•„ë˜ì˜ ì£¼ì„ ì°¸ê³ ) í›„ ë‹¤ì‹œ ì••ì¶•. 
ì˜ˆì‹œë¡œëŠ” `vi`ë¥¼ í™œìš©í–ˆì§€ë§Œ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œë“  ìˆ˜ì •í•˜ë©´ ëœë‹¤.
```bash
vi mmcv-full-1.7.0/setup.py 
# line 268, 362 to c++14 -> c++17
# í˜¹ì€ ëª¨ë“  c++14ë¥¼ c++17ë¡œ ì¹˜í™˜í•´ì„œ ëë‹¤ëŠ” github ë‹µê¸€ë„ ìˆìŒ

#ë‹¤ì‹œ ì••ì¶• í›„ ë””ë ‰í„°ë¦¬ ì œê±°
tar -zcvf mmcv-full-1.7.0.tar.gz mmcv-full-1.7.0
rm -rf mmcv-full-1.7.0
#ì•„ë˜ ì‚¬ì§„ ì°¸ê³ 
```

| `setup.py` - line 268 |
| - |
|<img src=https://velog.velcdn.com/images/deaf52/post/d96b25d4-5be1-4f18-a433-f843e0d65d0f/image.png>|

|`setup.py` - line 362|
| - |
| <img src=https://velog.velcdn.com/images/deaf52/post/76ec984f-6c0f-4e82-b23d-50fceba63b03/image.png>|

3. Dockerfile ìˆ˜ì • (AnimatedDrawings/torchserve/Dockerfile)
   - `docker build -t docker_torchserve .`ë¥¼ ì‹¤í–‰í•  ë•Œ ì´ ì„¤ì¹˜íŒŒì¼ì„ ì‚¬ìš©í•˜ë„ë¡ `Dockerfile` ìˆ˜ì •
```bash
cd .. #cd AnimatedDrawings/torchserve
vi Dockerfile  
#ì¶”ê°€) COPY my-mmcv/mmcv-full-1.7.0.tar.gz /tmp/mmcv-full-1.7.0.tar.gz
#ìˆ˜ì •) RUN mim install /tmp/mmcv-full-1.7.0.tar.gz
#ì•„ë˜ ì‚¬ì§„ ì°¸ì¡°
```
![](https://velog.velcdn.com/images/deaf52/post/8dabe5c0-13a1-4488-bd9c-4d53b3fe8b7f/image.png)


- ë‹¤ì‹œ `build`ë° `run`, í™•ì¸
```bash
# ì»´í“¨í„° ìì›ì— ë”°ë¼ 20ë¶„ ì´ìƒ ì†Œìš”ë  ìˆ˜ ìˆë‹¤.
docker build -t docker_torchserve .

docker run -d --name docker_torchserve -p 8080:8080 -p 8081:8081 docker_torchserve

# ì»¨í…Œì´ë„ˆê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„(5~10ì´ˆ) ìƒíƒœ í™•ì¸
curl http://localhost:8080/ping
# healthyê°€ ì¶œë ¥ë˜ì–´ì•¼ í•œë‹¤.
```

### # 3. ì˜ˆì œíŒŒì¼ ì‹¤í–‰

```bash
cd ../examples #cd AnimatedDrawings/examples
python image_to_animation.py drawings/garlic.png garlic_out
```
- image_to_animation.py íŒŒì¼ì„ ì´ìš©í•˜ì—¬ `AnimatedDrawings/examples/drawings`í´ë”ì— ìˆëŠ” garlic.pngë¥¼ ì²˜ë¦¬í•˜ì—¬ ì‚°ì¶œë¬¼ë“¤ì„ `AnimatedDrawings/examples/garlic_out`ì— ì €ì¥í•œë‹¤.

![](https://velog.velcdn.com/images/deaf52/post/64c26d51-dd72-4342-843d-1ec6323725a1/image.png)
- ìœ„ì™€ ê°™ì€ ì‚°ì¶œë¬¼ë“¤ì´ ë‚˜ì˜¤ëŠ”ë° `video.gif`ê°€ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ì´ê³  ë‚˜ë¨¸ì§€ëŠ” ì¤‘ê°„ê³¼ì •ì—ì„œ ë‚˜ì˜¤ëŠ” ì‚°ì¶œë¬¼ë“¤ì´ë‹¤. 

- `drawings`í´ë”ì— ë‹¤ì–‘í•œ í˜•íƒœì˜ ìºë¦­í„°ë“¤ì„ ì§‘ì–´ë†“ê³  í´ë”ë„ ë”°ë¡œ ëª…ì‹œí•˜ì—¬ ì‚°ì¶œë¬¼ë“¤ì„ ìƒì„±í•´ë³¼ ìˆ˜ ìˆê² ë‹¤.

- ì¸í’‹ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ìºë¦­í„° ì´ë¯¸ì§€ëŠ” ì£¼ì˜í•  ì ì´ ìˆë‹¤.
  1. **ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ëŒí˜•íƒœë§Œ ì¸ì‹í•œë‹¤.**
  ì‚¬ì¡±ë³´í–‰ ë™ë¬¼ë“¤ì„ ë§ì´ í…ŒìŠ¤íŠ¸í•´ë³¼í…ë° ê²°ê³¼ê°€ ì¢‹ì§€ ì•Šë‹¤.
     - ê¹ƒí—ˆë¸Œ readmeì˜ ë’·ë¶€ë¶„ì— ë‹¤ë¥¸ í˜•íƒœì˜ ê³¨ê²©ì„ ì„¤ì •í•˜ëŠ” ê°€ì´ë“œê°€ ìˆê³ , í›„ì— ì‘ì„±í•  ì»¤ìŠ¤í„°ë§ˆì´ì§• ì•„í‹°í´ì—ë„ ì¶”ê°€ ê¸°ìˆ í•  ì˜ˆì •.
     
  2. **íŒ”ë‹¤ë¦¬ê°€ ëª…í™•íˆ ë–¨ì–´ì ¸ ìˆì–´ì•¼í•œë‹¤.**
  íŒ”ë‹¤ë¦¬ê°€ ëª¸í†µì— ë¶™ì–´ìˆê±°ë‚˜ ëª¸í†µ ì•ˆìª½ì— ê·¸ë ¤ì ¸ìˆì–´ì„œ êµ¬ë¶„ì´ ëª…í™•ì¹˜ ì•Šì€ ê²½ìš° ì›í•˜ì§€ ì•ŠëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.
     - ë‹¨ìˆœíˆ ì¸ì‹ìì²´ë¥¼ ì˜ ëª»í•˜ëŠ” ê²½ìš° `fix`ê¸°ëŠ¥ìœ¼ë¡œ ê³ ì¹  ìˆ˜ ìˆë‹¤. ì´ê²ƒë„ 1ë²ˆì˜ ê³¨ê²©ì„¤ì •ê¸°ëŠ¥ì²˜ëŸ¼ í›„ì˜ ê²Œì‹œê¸€ì—ì„œ ë‹¤ë£¨ê±°ë‚˜ readmeì—ì„œ í™•ì¸í•˜ë©´ ëœë‹¤.
     
 ë‹¤ìŒ ê²Œì‹œê¸€ì—ì„œëŠ” í”Œë¼ìŠ¤í¬ë¥¼ ì´ìš©í•´ `input -> output`ì´ ë˜ëŠ” ì„œë²„êµ¬ì¡°ë¥¼ ì‘ì„±í•˜ëŠ” ë“± ìë™í™”ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•´ë³´ë„ë¡ í•˜ì.
 
 [ğŸ‘‰ë‹¤ìŒ ê²Œì‹œê¸€ ë°”ë¡œê°€ê¸°(ì‘ì„±ì¤‘)]()
